---
- name: Set Explorer's default layout and view to 'List'.
  ansible.windows.win_regedit:
    path: >
      HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Streams\Defaults
    name: "{5C4F28B5-F869-4E84-8E60-F11DB97C5CC7}"
    data: >
      hex:1c,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,
      00,00,00,00,00,f1,f1,f1,f1,14,00,00,00,00,00,00,00,00,00,00,00,00,00,00,
      00,e8,02,00,00,e4,02,00,00,31,53,50,53,05,d5,cd,d5,9c,2e,1b,10,93,97,08,
      00,2b,2c,f9,ae,83,00,00,00,22,00,00,00,00,47,00,72,00,6f,00,75,00,70,00,
      42,00,79,00,4b,00,65,00,79,00,3a,00,46,00,4d,00,54,00,49,00,44,00,00,00,
      08,00,00,00,4e,00,00,00,7b,00,30,00,30,00,30,00,30,00,30,00,30,00,30,00,
      30,00,2d,00,30,00,30,00,30,00,30,00,2d,00,30,00,30,00,30,00,30,00,2d,00,
      30,00,30,00,30,00,30,00,2d,00,30,00,30,00,30,00,30,00,30,00,30,00,30,00,
      30,00,30,00,30,00,30,00,30,00,7d,00,00,00,00,00,33,00,00,00,22,00,00,00,
      00,47,00,72,00,6f,00,75,00,70,00,42,00,79,00,44,00,69,00,72,00,65,00,63,
      00,74,00,69,00,6f,00,6e,00,00,00,13,00,00,00,01,00,00,00,73,00,00,00,0a,
      00,00,00,00,53,00,6f,00,72,00,74,00,00,00,42,00,00,00,1e,00,00,00,70,00,
      72,00,6f,00,70,00,34,00,32,00,39,00,34,00,39,00,36,00,37,00,32,00,39,00,
      35,00,00,00,00,00,34,00,00,00,02,00,00,00,30,f1,25,b7,ef,47,1a,10,a5,f1,
      02,60,8c,9e,eb,ac,04,00,00,00,01,00,00,00,30,f1,25,b7,ef,47,1a,10,a5,f1,
      02,60,8c,9e,eb,ac,0a,00,00,00,01,00,00,00,25,00,00,00,14,00,00,00,00,47,
      00,72,00,6f,00,75,00,70,00,56,00,69,00,65,00,77,00,00,00,0b,00,00,00,00,
      00,00,00,1b,00,00,00,0a,00,00,00,00,4d,00,6f,00,64,00,65,00,00,00,13,00,
      00,00,03,00,00,00,23,00,00,00,12,00,00,00,00,49,00,63,00,6f,00,6e,00,53,
      00,69,00,7a,00,65,00,00,00,13,00,00,00,10,00,00,00,bd,00,00,00,10,00,00,
      00,00,43,00,6f,00,6c,00,49,00,6e,00,66,00,6f,00,00,00,42,00,00,00,1e,00,
      00,00,70,00,72,00,6f,00,70,00,34,00,32,00,39,00,34,00,39,00,36,00,37,00,
      32,00,39,00,35,00,00,00,00,00,78,00,00,00,fd,df,df,fd,10,00,00,00,00,00,
      00,00,00,00,00,00,04,00,00,00,18,00,00,00,30,f1,25,b7,ef,47,1a,10,a5,f1,
      02,60,8c,9e,eb,ac,0a,00,00,00,10,01,00,00,30,f1,25,b7,ef,47,1a,10,a5,f1,
      02,60,8c,9e,eb,ac,0e,00,00,00,90,00,00,00,30,f1,25,b7,ef,47,1a,10,a5,f1,
      02,60,8c,9e,eb,ac,04,00,00,00,78,00,00,00,30,f1,25,b7,ef,47,1a,10,a5,f1,
      02,60,8c,9e,eb,ac,0c,00,00,00,50,00,00,00,2f,00,00,00,1e,00,00,00,00,47,
      00,72,00,6f,00,75,00,70,00,42,00,79,00,4b,00,65,00,79,00,3a,00,50,00,49,
      00,44,00,00,00,13,00,00,00,00,00,00,00,1f,00,00,00,0e,00,00,00,00,46,00,
      46,00,6c,00,61,00,67,00,73,00,00,00,13,00,00,00,01,00,20,41,31,00,00,00,
      20,00,00,00,00,4c,00,6f,00,67,00,69,00,63,00,61,00,6c,00,56,00,69,00,65,
      00,77,00,4d,00,6f,00,64,00,65,00,00,00,13,00,00,00,04,00,00,00,00,00,00,
      00,00,00,00,00
    type: binary

- name: Enable the file extension in file names.
  ansible.windows.win_regedit:
    path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
    name: HideFileExt
    data: 0
    type: dword

- name: Set Explorer to the Computer view.
  ansible.windows.win_regedit:
    path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
    name: LaunchTo
    data: 1
    type: dword

- name: Disable Ribbon menu in Windows Explorer.
  ansible.windows.win_regedit:
    path: HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Ribbon
    name: MinimizedStateTabletModeOff
    data: 1
    type: dword

- name: Enable Right-click Context Menu.
  ansible.windows.win_regedit:
    path: >
      HKCU:\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32
    data: ""
    type: none
